import csv

def compare_datasets(file_path):
    # Lists to store our key-value pairs (IP, Hostname)
    set_a = set()
    set_b = set()

    try:
        with open(file_path, mode='r', newline='') as csvfile:
            # Using DictReader to handle potential column headers
            # Note: Adjust fieldnames if your CSV doesn't have headers
            reader = csv.DictReader(csvfile)
            
            for row in reader:
                # Store Dataset 1 as a tuple (IP, Hostname) in set_a
                # We strip whitespace to ensure clean matching
                if row['IP1'] and row['Hostname1']:
                    set_a.add((row['IP1'].strip(), row['Hostname1'].strip()))
                
                # Store Dataset 2 as a tuple (IP, Hostname) in set_b
                if row['IP2'] and row['Hostname2']:
                    set_b.add((row['IP2'].strip(), row['Hostname2'].strip()))

        # Find items in Dataset 1 that are NOT in Dataset 2
        unique_to_a = set_a - set_b
        
        # Find items in Dataset 2 that are NOT in Dataset 1
        unique_to_b = set_b - set_a

        # Present the unique data
        print("--- Unique to Dataset 1 ---")
        for ip, host in unique_to_a:
            print(f"IP: {ip} | Hostname: {host}")

        print("\n--- Unique to Dataset 2 ---")
        for ip, host in unique_to_b:
            print(f"IP: {ip} | Hostname: {host}")

    except FileNotFoundError:
        print("Error: The CSV file was not found.")
    except KeyError:
        print("Error: Ensure CSV headers match 'IP1', 'Hostname1', 'IP2', 'Hostname2'.")

if __name__ == "__main__":
    # Call the function with your filename
    compare_datasets('data.csv')
