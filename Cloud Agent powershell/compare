import pandas as pd
import os

def compare_csv_to_table(file_path):
    # Check if the file exists on the local machine
    if not os.path.exists(file_path):
        print(f"Error: File not found at {file_path}")
        return

    # Load the CSV file into a pandas DataFrame
    # This automatically handles headers and column organization
    try:
        df = pd.read_csv(file_path)
        
        # Create sets of (IP, Hostname) tuples for both datasets
        # This keeps the pairs associated as requested
        set_1 = set(zip(df['IP1'].strip(), df['Hostname1'].strip()))
        set_2 = set(zip(df['IP2'].strip(), df['Hostname2'].strip()))
    except Exception as e:
        # Fallback if manual column names are needed or if stripping fails on NaNs
        df = pd.read_csv(file_path).fillna('Missing')
        set_1 = set(zip(df['IP1'], df['Hostname1']))
        set_2 = set(zip(df['IP2'], df['Hostname2']))

    # Use set operations to find unique pairs
    unique_1 = list(set_1 - set_2)
    unique_2 = list(set_2 - set_1)

    # Convert the results into DataFrames for pretty table display
    df_unique_1 = pd.DataFrame(unique_1, columns=['IP', 'Hostname'])
    df_unique_2 = pd.DataFrame(unique_2, columns=['IP', 'Hostname'])

    # Display results in a clean table format
    print("\n" + "="*40)
    print("DATASET 1: UNIQUE ITEMS NOT IN DATASET 2")
    print("="*40)
    if not df_unique_1.empty:
        print(df_unique_1.to_string(index=False))
    else:
        print("No unique items found.")

    print("\n" + "="*40)
    print("DATASET 2: UNIQUE ITEMS NOT IN DATASET 1")
    print("="*40)
    if not df_unique_2.empty:
        print(df_unique_2.to_string(index=False))
    else:
        print("No unique items found.")

if __name__ == "__main__":
    # Define your local file path
    # Remember 'r' prefix for Windows paths
    target_file = r'C:\User\Name\data_sets.csv'
    
    # Execute the comparison and table display
    compare_csv_to_table(target_file)
